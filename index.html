<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –∫–æ—Ç–∞ –§—å—é–º–∏–∫–∞</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: linear-gradient(#e3f2fd, #bbdefb);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .game-container {
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
      max-width: 480px;
      width: 100%;
      padding: 16px 16px 20px;
      box-sizing: border-box;
      position: relative;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      font-size: 14px;
      color: #455a64;
    }

    .track {
      position: relative;
      height: 80px;
      background: #e0f7fa;
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 12px;
      border: 2px solid #b2ebf2;
    }

    #hero {
      position: absolute;
      left: 8px;
      bottom: 4px;
      transition: left 0.4s ease-out;
    }

    /* üî• –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ–¥–ø—Ä—ã–≥–∏–≤–∞–Ω–∏—è */
    @keyframes jump {
      0%   { transform: translateY(0); }
      30%  { transform: translateY(-18px); }
      60%  { transform: translateY(0); }
      100% { transform: translateY(0); }
    }

    .jumping {
      animation: jump 0.5s ease-out;
    }

    .finish {
      position: absolute;
      right: 8px;
      top: 10px;
      bottom: 10px;
      width: 24px;
      background-image: linear-gradient(45deg, #000 25%, #fff 25%, #fff 50%, #000 50%, #000 75%, #fff 75%, #fff 100%);
      background-size: 12px 12px;
      border-radius: 6px;
    }

    .progress-bar {
      height: 8px;
      background: #e0e0e0;
      border-radius: 999px;
      overflow: hidden;
      margin-bottom: 12px;
    }

    .progress-inner {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #42a5f5, #66bb6a);
      transition: width 0.3s ease-out;
    }

    .question {
      background: #e8f5e9;
      border-radius: 12px;
      padding: 12px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
      color: #1b5e20;
      margin-bottom: 12px;
    }

    .answers {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
      margin-bottom: 10px;
    }

    .answer-btn {
      padding: 10px;
      border-radius: 10px;
      border: none;
      background: #e3f2fd;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: transform 0.1s, box-shadow 0.1s, background 0.2s;
    }

    .answer-btn.correct {
      background: #c8e6c9;
    }

    .answer-btn.wrong {
      background: #ffcdd2;
    }

    .message {
      min-height: 40px;
      font-size: 14px;
      color: #37474f;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .bottom-bar {
      margin-top: 8px;
      display: flex;
      justify-content: space-between;
      font-size: 13px;
      color: #607d8b;
    }

    .restart-btn {
      border: none;
      background: #42a5f5;
      color: #fff;
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 13px;
      cursor: pointer;
    }

    /* üå§Ô∏è –ì–æ–ª—É–±–æ–π —ç–∫—Ä–∞–Ω –ø–µ—Ä–µ—Ö–æ–¥–∞ */
    .level-screen {
      position: absolute;
      inset: 0;
      background: #cfe9ff;
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 20px;
      border-radius: 16px;
    }

    .level-screen h2 {
      color: white;
      font-size: 26px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.25);
      margin-bottom: 12px;
    }

    .continue-btn {
      margin-top: 12px;
      padding: 10px 20px;
      background: white;
      border: 2px solid #42a5f5;
      border-radius: 12px;
      font-size: 18px;
      cursor: pointer;
      color: #1e88e5;
      font-weight: 600;
    }
  </style>
</head>

<body>
  <div class="game-container">

    <div class="header">
      <div class="fuel">–¢–æ–ø–ª–∏–≤–æ: <span id="fuel">100</span>%</div>
      <div class="task-counter">–ó–∞–¥–∞—á–∞: <span id="taskIndex">1</span> / <span id="taskTotal">4</span></div>
    </div>

    <div class="track">
      <div id="hero">
        <img src="https://raw.githubusercontent.com/larakrav25-pixel/flumik-game/main/ba9ca989-1775-4f89-96b9-6ab84b602465.png" height="70">
      </div>
      <div class="finish"></div>
    </div>

    <div class="progress-bar">
      <div class="progress-inner" id="progress"></div>
    </div>

    <div class="question" id="question"></div>
    <div class="answers" id="answers"></div>
    <div class="message" id="message"></div>

    <div class="bottom-bar">
      <span>–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –∫–æ—Ç–∞ –§—å—é–º–∏–∫–∞</span>
      <button class="restart-btn" id="restartBtn">–°–Ω–∞—á–∞–ª–∞</button>
    </div>

    <!-- üå§Ô∏è –≠–∫—Ä–∞–Ω –ø–µ—Ä–µ—Ö–æ–¥–∞ -->
    <div class="level-screen" id="levelScreen">
      <h2 id="levelMessage"></h2>
      <button class="continue-btn" id="continueBtn">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
    </div>

  </div>

  <!-- üîä –ó–≤—É–∫–∏ -->
  <audio id="correctSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_7b8e0f3c8d.mp3?filename=bird-chirp-1-177906.mp3"></audio>
  <audio id="wrongSound" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_7f3a3c2e2a.mp3?filename=soft-hit-1-7051.mp3"></audio>

  <script>
    const URL_FANTIK = "https://raw.githubusercontent.com/larakrav25-pixel/flumik-game/main/ba9ca989-1775-4f89-96b9-6ab84b602465.png";
   const URL_PYSHKIN = "https://raw.githubusercontent.com/larakrav25-pixel/-fiumik-game/main/9cc9e602-8bc5-428d-8ffc-92f643172457.png";

    const levels = [
      [
        { q: "125 + 230 = ?", options: [355, 345, 365, 325], correct: 355 },
        { q: "480 + 120 = ?", options: [600, 580, 620, 590], correct: 600 },
        { q: "345 + 255 = ?", options: [600, 580, 590, 610], correct: 600 },
        { q: "560 + 140 = ?", options: [700, 690, 710, 720], correct: 700 }
      ],
      [
        { q: "402 - 178 = ?", options: [224, 214, 234, 244], correct: 224 },
        { q: "350 - 125 = ?", options: [225, 235, 215, 245], correct: 225 },
        { q: "600 - 289 = ?", options: [311, 321, 301, 331], correct: 311 },
        { q: "540 - 260 = ?", options: [280, 260, 300, 320], correct: 280 }
      ],
      [
        { q: "48 √∑ 6 = ?", options: [8, 6, 7, 9], correct: 8 },
        { q: "63 √∑ 7 = ?", options: [9, 8, 7, 6], correct: 9 },
        { q: "12 √ó 4 = ?", options: [48, 44, 52, 36], correct: 48 },
        { q: "15 √ó 3 = ?", options: [45, 35, 40, 50], correct: 45 }
      ],
      [
        { q: "324 √∑ 6 = ?", options: [54, 64, 44, 48], correct: 54 },
        { q: "450 √∑ 9 = ?", options: [50, 40, 45, 55], correct: 50 },
        { q: "125 √ó 4 = ?", options: [500, 450, 400, 550], correct: 500 },
        { q: "240 √ó 3 = ?", options: [720, 620, 840, 600], correct: 720 }
      ]
    ];

    const phrasesCorrect = [
      `–§–∞–Ω—Ç–∏–∫ <img src="${URL_FANTIK}" height="22"> —Ä–∞–¥–æ—Å—Ç–Ω–æ —á–∏—Ä–∏–∫–∞–µ—Ç!`,
      `–§–∞–Ω—Ç–∏–∫ <img src="${URL_FANTIK}" height="22"> –∫—Ä–∏—á–∏—Ç: ¬´–ß–∏—Ä–∏–∫! –ú–æ–ª–æ–¥–µ—Ü!¬ª`,
      `–§–∞–Ω—Ç–∏–∫ <img src="${URL_FANTIK}" height="22"> —Ö–ª–æ–ø–∞–µ—Ç –∫—Ä—ã–ª—ã—à–∫–∞–º–∏!`
    ];

    const phrasesWrong = [
      `–ü—ã—à–∫–∏–Ω <img src="${URL_PYSHKIN}" height="26"> —É—Ä–æ–Ω–∏–ª –∫–µ–∫—Å –æ—Ç –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ—Å—Ç–∏!`,
      `–ü—ã—à–∫–∏–Ω <img src="${URL_PYSHKIN}" height="26"> —É–¥–∏–≤–ª—ë–Ω: ¬´–û–π, –∫–∞–∂–µ—Ç—Å—è, –Ω–µ —Ç–æ‚Ä¶¬ª`,
      `–ü—ã—à–∫–∏–Ω <img src="${URL_PYSHKIN}" height="26"> –≥–æ–≤–æ—Ä–∏—Ç: ¬´–ü–æ–ø—Ä–æ–±—É–µ–º –µ—â—ë —Ä–∞–∑?¬ª`
    ];

    let level = 0;
    let task = 0;
    let fuel = 100;

    const questionEl = document.getElementById("question");
    const answersEl = document.getElementById("answers");
    const messageEl = document.getElementById("message");
    const fuelEl = document.getElementById("fuel");
    const taskIndexEl = document.getElementById("taskIndex");
    const taskTotalEl = document.getElementById("taskTotal");
    const progressEl = document.getElementById("progress");
    const heroEl = document.getElementById("hero");
    const restartBtn = document.getElementById("restartBtn");

    const levelScreen = document.getElementById("levelScreen");
    const levelMessage = document.getElementById("levelMessage");
    const continueBtn = document.getElementById("continueBtn");

    const correctSound = document.getElementById("correctSound");
    const wrongSound = document.getElementById("wrongSound");

    taskTotalEl.textContent = levels[level].length;

    function updateHeroPosition() {
      const percent = (task / levels[level].length) * 100;
      heroEl.style.left = 8 + (percent * 0.7) + "%";
      progressEl.style.width = percent + "%";
    }

    function setFuel(value) {
      fuel = Math.max(0, Math.min(100, value));
      fuelEl.textContent = fuel;
    }

    function randomFrom(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function renderTask() {
      const t = levels[level][task];
      questionEl.textContent = t.q;
      taskIndexEl.textContent = task + 1;
      answersEl.innerHTML = "";
      messageEl.innerHTML = "";

      t.options.forEach(opt => {
        const btn = document.createElement("button");
        btn.className = "answer-btn";
        btn.textContent = opt;
        btn.onclick = () => handleAnswer(opt, btn);
        answersEl.appendChild(btn);
      });

      updateHeroPosition();
    }

    function handleAnswer(answer, btn) {
      const t = levels[level][task];
      const buttons = Array.from(document.querySelectorAll(".answer-btn"));
      buttons.forEach(b => b.disabled = true);

      if (answer === t.correct) {
        btn.classList.add("correct");
        messageEl.innerHTML = randomFrom(phrasesCorrect);

        correctSound.currentTime = 0;
        correctSound.play();

        heroEl.classList.add("jumping");
        setTimeout(() => heroEl.classList.remove("jumping"), 500);

        setFuel(fuel + 5);
        task++;

        setTimeout(() => {
          if (task < levels[level].length) {
            renderTask();
          } else {
            showLevelScreen();
          }
        }, 700);

      } else {
        btn.classList.add("wrong");
        messageEl.innerHTML = randomFrom(phrasesWrong);

        wrongSound.currentTime = 0;
        wrongSound.play();

        setFuel(fuel - 10);

        setTimeout(() => {
          buttons.forEach(b => {
            b.disabled = false;
            b.classList.remove("wrong");
          });
          messageEl.innerHTML = "";
        }, 800);
      }
    }

    function showLevelScreen() {
      setFuel(fuel + 30);

      if (level < 3) {
        levelMessage.textContent = `–§–∞–Ω—Ç–∏–∫ —Ä–∞–¥–æ—Å—Ç–Ω–æ —á–∏—Ä–∏–∫–∞–µ—Ç: —É—Ä–æ–≤–µ–Ω—å ${level + 1} –ø—Ä–æ–π–¥–µ–Ω! –¢–æ–ø–ª–∏–≤–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ 30% ‚Äî –º–æ–∂–Ω–æ –ª–µ—Ç–µ—Ç—å –¥–∞–ª—å—à–µ!`;
      } else {
        levelMessage.textContent = `–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—Å–µ —É—Ä–æ–≤–Ω–∏ –ø—Ä–æ–π–¥–µ–Ω—ã! –§—å—é–º–∏–∫ –∏ –§–∞–Ω—Ç–∏–∫ –≥–æ—Ä–¥—è—Ç—Å—è —Ç–æ–±–æ–π!`;
      }

      levelScreen.style.display = "flex";
    }

    continueBtn.onclick = () => {
      levelScreen.style.display = "none";

      if (level < 3) {
        level++;
        task = 0;
        taskTotalEl.textContent = levels[level].length;
        renderTask();
      } else {
        questionEl.textContent = "–§–∏–Ω–∏—à!";
        answersEl.innerHTML = "";
        messageEl.innerHTML = "–¢—ã –ø—Ä–æ—à—ë–ª –≤—Å–µ —É—Ä–æ–≤–Ω–∏!";
      }
    };

    function restartGame() {
      level = 0;
      task = 0;
      setFuel(100);
      taskTotalEl.textContent = levels[level].length;
      renderTask();
    }

    restartBtn.addEventListener("click", restartGame);

    renderTask();
  </script>
</body>

</html>
